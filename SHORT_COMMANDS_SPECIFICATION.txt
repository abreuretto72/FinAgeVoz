# üé§ Comandos Curtos - Assun√ß√£o de Dados Omissos

## üéØ Objetivo
Permitir que o usu√°rio registre transa√ß√µes de forma ultra-r√°pida, dizendo apenas o essencial (ex: "Uber 10 reais"), sem precisar especificar verbo, status ou data.

---

## üìã REGRAS DE ASSUN√á√ÉO

### **1. Regra de Omiss√£o de Verbo (A√ß√£o Padr√£o)**

**Princ√≠pio:** Se o usu√°rio N√ÉO usar verbo, assumir DESPESA (sa√≠da).

**Padr√£o:** `[Entidade/Local] + [Valor]` = DESPESA PAGA

**Exemplos:**
```
"Uber 10 reais"          ‚Üí Despesa | Uber | 10.00 | Pago | Transporte
"Almo√ßo 35"              ‚Üí Despesa | Almo√ßo | 35.00 | Pago | Alimenta√ß√£o
"Mercado 150"            ‚Üí Despesa | Mercado | 150.00 | Pago | Alimenta√ß√£o
"Gasolina 200"           ‚Üí Despesa | Gasolina | 200.00 | Pago | Transporte
"Farm√°cia 45,50"         ‚Üí Despesa | Farm√°cia | 45.50 | Pago | Sa√∫de
```

**Exce√ß√µes (com verbo = pode ser receita):**
```
"Vendi bolo 50"          ‚Üí Receita | Bolo | 50.00 | Pago | Vendas
"Recebi sal√°rio 3000"    ‚Üí Receita | Sal√°rio | 3000.00 | Pago | Sal√°rio
"Ganhei 100"             ‚Üí Receita | Ganho | 100.00 | Pago | Outras Receitas
```

---

### **2. Regra de Status Financeiro (Status Padr√£o)**

**Princ√≠pio:** Comandos curtos = transa√ß√£o J√Å REALIZADA (paga).

**Padr√£o:** `isPaid = true` | `paymentDate = hoje`

**Exce√ß√µes (palavras-chave que indicam PENDENTE):**
- "agendar"
- "para pagar"
- "vence dia"
- "boleto"
- "fatura"
- "conta para pagar"

**Exemplos:**
```
"Uber 10"                      ‚Üí isPaid: true, paymentDate: hoje
"Almo√ßo 35"                    ‚Üí isPaid: true, paymentDate: hoje
"Agendar conta de luz 150"     ‚Üí isPaid: false, paymentDate: null
"Boleto 200 vence dia 25"      ‚Üí isPaid: false, dueDate: dia 25
```

---

### **3. Regra de Data e Hora**

**Princ√≠pio:** Se n√£o mencionar data, assumir HOJE.

**Padr√£o:** `date = hoje` | `time = agora`

**Exemplos:**
```
"Uber 10"                ‚Üí date: 2025-12-19, time: 07:03
"Almo√ßo 35 ontem"        ‚Üí date: 2025-12-18, time: null
"Mercado 150 dia 15"     ‚Üí date: 2025-12-15, time: null
```

---

### **4. Fluxo de Confirma√ß√£o Inteligente**

**Princ√≠pio:** Confirmar de forma breve e clara.

**Formato:** "Registrado: [valor] para [descri√ß√£o] em [categoria]. Pago hoje."

**Exemplos:**
```
Usu√°rio: "Uber 10 reais"
IA: "Registrado: 10 reais para Uber em Transporte. Pago hoje."

Usu√°rio: "Almo√ßo 35"
IA: "Registrado: 35 reais para Almo√ßo em Alimenta√ß√£o. Pago hoje."

Usu√°rio: "Vendi bolo 50"
IA: "Registrado: 50 reais de venda de Bolo. Recebido hoje."
```

---

### **5. Tratamento de Ambiguidade**

**Valores Negativos:**
```
"Uber menos 10"          ‚Üí Estorno/Ajuste | -10.00
"Estorno Uber 10"        ‚Üí Estorno | -10.00 (reversal)
```

**Valores Positivos Isolados:**
```
"10 reais"               ‚Üí Despesa gen√©rica | 10.00
"50"                     ‚Üí Despesa gen√©rica | 50.00
```

---

## üîÑ PROCESSAMENTO INTERNO

### **Tabela de Mapeamento:**

| Comando de Voz | Interpreta√ß√£o | A√ß√£o no Banco |
|----------------|---------------|---------------|
| "Uber 10,00" | Despesa confirmada (sem verbo) | `INSERT INTO transactions (description, amount, isExpense, isPaid, date, category) VALUES ('Uber', -10.00, true, true, '2025-12-19', 'Transporte')` |
| "Almo√ßo 35" | Despesa confirmada (sem verbo) | `INSERT INTO transactions (description, amount, isExpense, isPaid, date, category) VALUES ('Almo√ßo', -35.00, true, true, '2025-12-19', 'Alimenta√ß√£o')` |
| "Vendi bolo 50" | Receita (verbo 'vendi') | `INSERT INTO transactions (description, amount, isExpense, isPaid, date, category) VALUES ('Bolo', 50.00, false, true, '2025-12-19', 'Vendas')` |
| "Gasolina 200" | Despesa confirmada | `INSERT INTO transactions (description, amount, isExpense, isPaid, date, category) VALUES ('Gasolina', -200.00, true, true, '2025-12-19', 'Transporte')` |
| "Agendar luz 150" | Despesa pendente (palavra-chave) | `INSERT INTO transactions (description, amount, isExpense, isPaid, date, category) VALUES ('Luz', -150.00, true, false, '2025-12-19', 'Contas Fixas')` |

---

## üß† L√ìGICA DE DETEC√á√ÉO

### **Padr√£o de Comando Curto:**
```
REGEX: ^([A-Za-z√Ä-√ø\s]+)\s+(\d+(?:[.,]\d{1,2})?)(?:\s+reais)?$

Grupos:
- Grupo 1: Descri√ß√£o (ex: "Uber", "Almo√ßo", "Gasolina")
- Grupo 2: Valor (ex: "10", "35", "200", "45,50")
```

### **Algoritmo de Decis√£o:**

```python
def processar_comando_curto(input):
    # 1. Detectar padr√£o curto
    if match_pattern(input, COMANDO_CURTO_REGEX):
        descricao = grupo1
        valor = grupo2
        
        # 2. Verificar verbo de receita
        if contains_verbo_receita(input):  # "vendi", "recebi", "ganhei"
            tipo = "RECEITA"
            isExpense = false
        else:
            tipo = "DESPESA"
            isExpense = true
        
        # 3. Verificar status
        if contains_palavra_pendente(input):  # "agendar", "boleto", "vence"
            isPaid = false
        else:
            isPaid = true
        
        # 4. Definir data
        if contains_data(input):
            date = extrair_data(input)
        else:
            date = hoje()
        
        # 5. Mapear categoria
        categoria = mapear_categoria(descricao)
        
        # 6. Criar transa√ß√£o
        return {
            "intent": "ADD_TRANSACTION",
            "transaction": {
                "description": descricao,
                "amount": valor,
                "isExpense": isExpense,
                "isPaid": isPaid,
                "date": date,
                "category": categoria
            }
        }
```

---

## üìö DICION√ÅRIO DE SIN√îNIMOS PARA CATEGORIAS

### **Transporte:**
- uber, 99, taxi, t√°xi, √¥nibus, onibus, metr√¥, metro, gasolina, combust√≠vel, estacionamento

### **Alimenta√ß√£o:**
- almo√ßo, almoco, jantar, caf√©, cafe, lanche, mercado, supermercado, padaria, restaurante, ifood, delivery

### **Sa√∫de:**
- farm√°cia, farmacia, rem√©dio, remedio, m√©dico, medico, consulta, exame, hospital, dentista

### **Contas Fixas:**
- luz, √°gua, agua, internet, telefone, celular, aluguel, condom√≠nio, condominio, iptu, ipva

### **Lazer:**
- cinema, show, festa, viagem, passeio, parque, divers√£o, diversao

### **Educa√ß√£o:**
- curso, livro, escola, faculdade, mensalidade, material escolar

### **Vestu√°rio:**
- roupa, sapato, t√™nis, tenis, camisa, cal√ßa, calca

### **Outras Receitas:**
- venda, vendas, bico, extra, freelance, freela

---

## üé® EXEMPLOS DE USO COMPLETO

### **Cen√°rio 1: Registro R√°pido de Despesa**
```
Usu√°rio: "Uber 10 reais"

IA processa:
- Padr√£o detectado: COMANDO_CURTO
- Descri√ß√£o: "Uber"
- Valor: 10.00
- Tipo: DESPESA (sem verbo)
- Status: PAGO (sem palavra pendente)
- Data: 2025-12-19
- Categoria: Transporte (mapeamento autom√°tico)

IA responde: "Registrado: 10 reais para Uber em Transporte. Pago hoje."

Banco de dados:
{
  "description": "Uber",
  "amount": -10.00,
  "isExpense": true,
  "isPaid": true,
  "paymentDate": "2025-12-19",
  "date": "2025-12-19",
  "category": "Transporte"
}
```

### **Cen√°rio 2: Registro de Receita**
```
Usu√°rio: "Vendi bolo 50"

IA processa:
- Padr√£o detectado: COMANDO_CURTO
- Verbo detectado: "vendi" (receita)
- Descri√ß√£o: "Bolo"
- Valor: 50.00
- Tipo: RECEITA
- Status: PAGO
- Data: 2025-12-19
- Categoria: Vendas

IA responde: "Registrado: 50 reais de venda de Bolo. Recebido hoje."

Banco de dados:
{
  "description": "Bolo",
  "amount": 50.00,
  "isExpense": false,
  "isPaid": true,
  "paymentDate": "2025-12-19",
  "date": "2025-12-19",
  "category": "Vendas"
}
```

### **Cen√°rio 3: Agendamento de Conta**
```
Usu√°rio: "Agendar luz 150 dia 25"

IA processa:
- Padr√£o detectado: COMANDO_CURTO
- Palavra-chave: "agendar" (pendente)
- Descri√ß√£o: "Luz"
- Valor: 150.00
- Tipo: DESPESA
- Status: PENDENTE
- Data vencimento: 2025-12-25
- Categoria: Contas Fixas

IA responde: "Agendado: 150 reais para Luz em Contas Fixas. Vence dia 25."

Banco de dados:
{
  "description": "Luz",
  "amount": -150.00,
  "isExpense": true,
  "isPaid": false,
  "paymentDate": null,
  "date": "2025-12-25",
  "category": "Contas Fixas"
}
```

---

## üöÄ IMPLEMENTA√á√ÉO NO PROMPT DA IA

### **Adicionar ao ai_service.dart (ap√≥s se√ß√£o de TRANSACTIONS):**

```dart
SECTION: SHORT COMMANDS (QUICK ENTRY)
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

CRITICAL RULE: If user says ONLY [Description] + [Value] WITHOUT a verb, assume EXPENSE (paid).

Pattern: "[Entity/Place] [Value]" = EXPENSE | PAID | TODAY

Examples:
- "Uber 10 reais" -> {"intent": "ADD_TRANSACTION", "transaction": {"description": "Uber", "amount": 10.0, "isExpense": true, "isPaid": true, "date": "$currentDate", "category": "Transporte"}}
- "Almo√ßo 35" -> {"intent": "ADD_TRANSACTION", "transaction": {"description": "Almo√ßo", "amount": 35.0, "isExpense": true, "isPaid": true, "date": "$currentDate", "category": "Alimenta√ß√£o"}}
- "Mercado 150" -> {"intent": "ADD_TRANSACTION", "transaction": {"description": "Mercado", "amount": 150.0, "isExpense": true, "isPaid": true, "date": "$currentDate", "category": "Alimenta√ß√£o"}}
- "Gasolina 200" -> {"intent": "ADD_TRANSACTION", "transaction": {"description": "Gasolina", "amount": 200.0, "isExpense": true, "isPaid": true, "date": "$currentDate", "category": "Transporte"}}

EXCEPTIONS (with verb = can be income):
- "Vendi bolo 50" -> {"intent": "ADD_TRANSACTION", "transaction": {"description": "Bolo", "amount": 50.0, "isExpense": false, "isPaid": true, "date": "$currentDate", "category": "Vendas"}}
- "Recebi sal√°rio 3000" -> {"intent": "ADD_TRANSACTION", "transaction": {"description": "Sal√°rio", "amount": 3000.0, "isExpense": false, "isPaid": true, "date": "$currentDate", "category": "Sal√°rio"}}

PENDING KEYWORDS (isPaid: false):
- "agendar", "para pagar", "vence dia", "boleto", "fatura", "conta para pagar"

Example: "Agendar luz 150 dia 25" -> {"intent": "ADD_TRANSACTION", "transaction": {"description": "Luz", "amount": 150.0, "isExpense": true, "isPaid": false, "date": "2025-12-25", "category": "Contas Fixas"}}

CATEGORY MAPPING (auto-detect from description):
- Transporte: uber, 99, taxi, √¥nibus, metr√¥, gasolina, estacionamento
- Alimenta√ß√£o: almo√ßo, jantar, caf√©, lanche, mercado, supermercado, padaria, restaurante, ifood
- Sa√∫de: farm√°cia, rem√©dio, m√©dico, consulta, exame, hospital, dentista
- Contas Fixas: luz, √°gua, internet, telefone, celular, aluguel, condom√≠nio, iptu, ipva
- Lazer: cinema, show, festa, viagem, passeio, parque
- Educa√ß√£o: curso, livro, escola, faculdade, mensalidade
- Vestu√°rio: roupa, sapato, t√™nis, camisa, cal√ßa
- Vendas: venda, bico, extra, freelance

CONFIRMATION RESPONSE:
- Expense: "Registrado: [valor] para [descri√ß√£o] em [categoria]. Pago hoje."
- Income: "Registrado: [valor] de [descri√ß√£o]. Recebido hoje."
- Pending: "Agendado: [valor] para [descri√ß√£o]. Vence dia [data]."
```

---

**Criado em:** 19/12/2024  
**Autor:** Antigravity AI  
**Projeto:** FinAgeVoz Short Commands Enhancement
